# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å—Ç–∞—Ç—É—Å–∞ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ —Å–∞–π—Ç–µ Eltex-co.ru

## –û–ø–∏—Å–∞–Ω–∏–µ Workflow

**Eltex State Workflow** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å—Ç–∞—Ç—É—Å–∞ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ —Å–∞–π—Ç–µ eltex-co.ru –¥–ª—è –¥–∏–ª–µ—Ä–æ–≤. –ü–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ API Eltex, —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å—ã —Ç–æ–≤–∞—Ä–æ–≤, –ª–æ–≥–∏—Ä—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Supabase, —É–≤–µ–¥–æ–º–ª—è–µ—Ç –≤ Telegram –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö. –¢—Ä–∏–≥–≥–µ—Ä—ã: Manual –∏ Schedule (09:20).


## –í —ç—Ç–æ–º —Ä–∞–±–æ—á–µ–º –ø—Ä–æ—Ü–µ—Å—Å–µ —è –ø–æ–∫–∞–∑—ã–≤–∞—é —á–∞—Å—Ç—å —Ä–∞–±–æ—Ç—ã –ø–æ –≥–ª–æ–±–∞–ª—å–Ω–æ–º—É –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–∞ —Å–∞–π—Ç–µ eltex-co. 
–í –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–º —Ä–∞–±–æ—á–µ–º –ø—Ä–æ—Ü–µ—Å—Å–µ —É—á–∞—Å—Ç—É—é—Ç **–Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–æ–∫**:
- –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ,
- –Ω–∞ –æ—Ç–≤–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü –∫–æ–¥–æ–º 404,
- –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–∞–≤–∞ datdscheet,
- **–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Ç–æ–≤–∞—Ä–æ–≤ (–≠–¢–û–¢ WORKFLOW!)**,
- –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–≤–∞—Ä–æ–≤ –≤ —Ä–∞–∑–¥–µ–ª–∞—Ö —Å–∞–π—Ç–∞.
–î–ª—è –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ –¥–∏–ª–µ—Ä–∞ –∫—Ä–∞–π–Ω–µ –≤–∞–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å **—Ä—è–¥ –º–∞—Ä–∫–µ—Ä–æ–≤**, —á—Ç–æ–±—ã —Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ –º–µ–Ω—è—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –Ω–∞ —Å–≤–æ–µ–º —Å–∞–π—Ç–µ. –ü—Ä–∏ –ø–æ–º–æ—â–∏ —ç—Ç–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ –¥–∏–ª–µ—Ä–∞ **—Å—ç–∫–æ–Ω–æ–º–∏–ª–∏ –æ–∫–æ–ª–æ 20 —Ä–∞–±–æ—á–∏—Ö —á–∞—Å–æ–≤ –≤ –º–µ—Å—è—Ü**. –¢–µ–ø–µ—Ä—å –Ω–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –ø—Ä–æ–≤–µ—Ä—è—Ç—å –¥–∞–Ω–Ω—ã–µ - –±–æ—Ç –æ–ø–æ–≤–µ—Å—Ç–∏—Ç —É—Ç—Ä–æ–º, –µ—Å–ª–∏ –µ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —É –∑–∞–≤–æ–¥–∞-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è!

## –°—Ö–µ–º–∞ workflow
![Workflow](screen-bot.png)

## –¶–µ–ª—å

- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ —Ç–æ–≤–∞—Ä–æ–≤ Eltex.
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î Supabase.
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram –æ —Å–º–µ–Ω–µ —Å—Ç–∞—Ç—É—Å–∞.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ `workflow.json` –≤ n8n v2.4.4+.
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Credentials.
3. –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ Schedule Trigger –∏–ª–∏ Manual Execute.

## –°—Ö–µ–º–∞ workflow
![Workflow](screen.png)


## –¢—Ä–µ–±—É–µ–º—ã–µ API –ö–ª—é—á–∏
- Supabase
- Telegram
- Eltex API (–æ—Ç–∫—Ä—ã—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ)

## –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¢–∞–±–ª–∏—Ü Supabase

### –¢–∞–±–ª–∏—Ü–∞ `eltex_razdely_tovary`


| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ |
| :-- | :-- | :-- | :-- |
| `id` | number | PK | –§–∏–ª—å—Ç—Ä/UPDATE |
| `product_id` | number | ID —Ç–æ–≤–∞—Ä–∞ Eltex | Compare, Filter |
| `current_status` | string | –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å (old/new) | –°—Ä–∞–≤–Ω–µ–Ω–∏–µ old‚â†new |
| `currient_state_state` | string | –°–æ—Å—Ç–æ—è–Ω–∏–µ ('new') | –§–∏–ª—å—Ç—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ |
| `current_status_old`? | string | –°—Ç–∞—Ä—ã–π —Å—Ç–∞—Ç—É—Å | Set –Ω–æ–¥–∞ |
| `current_status_new` | string | –ù–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å –∏–∑ API | Set/UPDATE |


### –¢–∞–±–ª–∏—Ü–∞ `eltex_history`

- **–û–ø–µ—Ä–∞—Ü–∏–∏**: Insert (Create row).
- **–ü–æ–ª—è –¥–ª—è Insert**:


| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
| :-- | :-- | :-- | :-- |
| `message` | `eltex-co.ru {{product_name}} {{product_url}} {{current_status_new}}` | string | –õ–æ–≥ –∏–∑–º–µ–Ω–µ–Ω–∏—è |
| `created_at` | `now().format('yyyy-MM-dd')` | date | –î–∞—Ç–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è |
| `workflow` | `'eltex_state'` | string | –ò–º—è workflow |


**Rls/–ü–æ–ª–∏—Ç–∏–∫–∏**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Supabase Credentials –∏–º–µ—é—Ç –ø—Ä–∞–≤–∞ SELECT/INSERT/UPDATE. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Row Level Security –¥–ª—è prod.[^1]

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–ö–ª—é—á–µ–≤—ã–µ –£–∑–ª—ã)

- **–¢—Ä–∏–≥–≥–µ—Ä—ã**: ManualTrigger, ScheduleTrigger (09:20).
- **–õ–æ–≥–∏–∫–∞**: SplitInBatches ‚Üí IF (old ‚â† new) ‚Üí HTTP Eltex API ‚Üí Set states ‚Üí Supabase ops ‚Üí Telegram.
- **Sticky Notes**: –£–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ lifecycle, API calls, Supabase updates.

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã
- **–í–µ—Ä—à–∏–Ω–∏–Ω–∞ –ù–∞—Ç–∞–ª–∏—è** –º–∞—Ä–∫–µ—Ç–æ–ª–æ–≥ –∏ n8n-–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ç–æ—Ä
- **Telegram:** @vershininanata
- **Email:** vertunatpr@yandex.ru
- **–õ–æ–∫–∞—Ü–∏—è:** –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫, –†–æ—Å—Å–∏—è

## Topics / –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
- n8n 2.4.4
- eltex
- eltex api
- Workflow automation